{
  "name": "mubsub",
  "version": "0.2.2",
  "description": "Pub/sub for Node.js and MongoDB",
  "homepage": "http://github.com/scttnlsn/mubsub",
  "author": {
    "name": "Scott Nelson",
    "email": "scottbnel@gmail.com"
  },
  "main": "./lib/index",
  "keywords": [
    "mongodb",
    "pubsub",
    "pub",
    "sub",
    "capped collection"
  ],
  "contributors": [
    {
      "name": "Oleg Slobodskoi",
      "email": "oleg008@gmail.com"
    }
  ],
  "repository": {
    "type": "git",
    "url": "git://github.com/scttnlsn/mubsub.git"
  },
  "dependencies": {
    "mongoskin": ">= 0.3.7"
  },
  "devDependencies": {
    "mocha": ">= 1.0.0",
    "sinon": ">= 1.4.2"
  },
  "readme": "mubsub\n======\n\nMubsub is a pub/sub implementation for Node.js and MongoDB.  It utilizes Mongo's capped collections and tailable cursors to notify subscribers of inserted documents that match a given query.\n\nExample\n-------\n\n```javascript\nvar mubsub = require('mubsub');\n\nvar client = mubsub('mongodb://localhost:27017/mubsub_example');\nvar channel = client.channel('test');\n\nchannel.subscribe({ foo: 'bar' }, function(doc) {\n    console.log(doc.foo); // => 'bar'\n});\n\nchannel.subscribe({ foo: 'baz' }, function(doc) {\n    console.log(doc.foo); // => 'baz'\n});\n\nchannel.publish({ foo: 'bar' });\nchannel.publish({ foo: 'baz' });\n\n```\n\n### Caveats\n\n1. Ensure using poolSize > 1. Waiting for data will block 1 connection per subscription.\n\n    ```javascript\n    var client = mubsub('mongodb://localhost:27017/mubsub_example?poolSize=5');\n    ```\n\n2. Ensure setting auto_reconnect=true, default is false.\n\n    ```javascript\n    var client = mubsub('mongodb://localhost:27017/mubsub_example?auto_reconnect=true');\n    ```\n\n3. Avoid making lots of subscriptions. Use `channel.subscribe` less times than defined poolSize. Also at least one connection should be always free for publishing.\n\nUsage\n-----\n### Create a client\n\n```javascript\nvar mubsub = require('mubsub');\n\n// Using uri\nvar client = mubsub('mongodb://localhost:27017/mubsub_example');\n\n// Pass mongodb driver `Db` instance directly.\nvar client = mubsub(new Db(...));\n```\n\n### Channels ###\n\nA channel maps one-to-one with a capped collection (Mubsub will create these if they do not already exist in the database).  Optionally specify the byte size of the collection or/and max number of documents in the collection when creating a channel:\n\n```javascript\nvar channel = client.channel('foo', { size: 100000, max: 500 });\n```\n\n### Subscribe ###\n\n```javascript\nvar subscription = channel.subscribe(query, callback);\n```\n\nSubscriptions register a callback to be called whenever a document matching the specified query is inserted (published) into the collection (channel).  You can omit the query to match all inserted documents.  To later unsubscribe a particular callback, call `unsubscribe` on the returned subscription object:\n\n```javascript\nsubscription.unsubscribe();\n```\n\n### Publish ###\n\n```javascript\nchannel.publish(doc, callback);\n```\n\nPublishing a document simply inserts the document into the channel's capped collection.  Note that Mubsub will remove any specified document `_id` as the natural ordering of `ObjectId`s is used to ensure subscribers do not receive notifications of documents inserted in the past.  Callback is optional.\n\n### Close ###\n\n```javascript\nclient.close();\n```\n\nCloses the MongoDB connection.\n\n### Events ###\n\n```javascript\nchannel.on('error', function(err) {\n    console.log(err);\n});\n```\n\n\nInstall\n-------\n\n    npm install mubsub\n\nTests\n-----\n\n    make test\n\nYou can optionally specify the MongoDB URI to be used for tests:\n\n    MONGODB_URI=mongodb://localhost:27017/mubsub_tests make test\n",
  "readmeFilename": "README.md",
  "_id": "mubsub@0.2.2",
  "dist": {
    "shasum": "097cfd613c1d4583e8b01495636f5b1d05525f38"
  },
  "_from": "mubsub@0.2.x",
  "_resolved": "https://registry.npmjs.org/mubsub/-/mubsub-0.2.2.tgz"
}
